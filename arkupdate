#!/usr/bin/env bash

# local updateNeede=$?

mapfile -t instances < <( arkmanager list-instances --brief )
first="@${instances[0]}"

arkmanager checkupdate "$first"

updateNeeded=$?

[[ "$updateNeeded" -eq 0 ]] && exit 0

arkmanager update "$first" --downloadonly
arkmanager stop --warn --warnreason "Server update" --saveworld
arkmanager update "$first" --no-download
arkmanager start @all